{
  "metadata": {
    "offerName": "Work From Home - LocalJobMatcher",
    "offerCreator": "localjobsmatcher.com",
    "version": "7.0",
    "description": "Facebook flow with dynamic survey/offer page handling",
    "entryPoint": {
      "startUrl": "https://www.facebook.com/61575553191003/posts/pfbid0sdVc5c1ucHj7v9f9wLQ51JE9AL2JFbNn1sv4Aec6DmgT4rqqkkHTqH5n6g88rYeVl/?app=fbl"
    }
  },
  "funnel": {
    "pages": [
      {
        "pageNumber": 0,
        "pageName": "Facebook Post - Click Offer Link (Optional)",
        "pageDetection": {
          "checkForElement": "a[href*='opph3hftrk.com'], a[href*='HMLWQ96'], [href*='opph3hftrk.com']"
        },
        "fields": [],
        "navigation": {
          "type": "link",
          "selectors": [
            "a[href*='opph3hftrk.com/HMLWQ96/261TC5C']",
            "a[href*='opph3hftrk.com']",
            "a[href*='HMLWQ96']",
            "a[href*='261TC5C']"
          ],
          "waitAfterClick": 30000,
          "waitForUrlChange": false,
          "retryIfNoNavigation": true,
          "maxWaitTime": 90000,
          "expectNewTab": true
        }
      },
      {
        "pageNumber": 1,
        "pageName": "ZIP Code Entry",
        "pageDetection": {
          "checkForElement": "input[name='l-input'], input[placeholder='Zip Code'], [data-testid='viewJobsButton']"
        },
        "fields": [
          {
            "fieldType": "zipCode",
            "selectors": [
              "input[name='l-input']:visible",
              "input[placeholder='Zip Code']:visible",
              "input[type='text'][maxlength='5']:visible",
              "input[type='text']:visible:first"
            ],
            "action": "clear_and_type"
          }
        ],
        "navigation": {
          "type": "button",
          "selectors": [
            "[data-testid='viewJobsButton']:visible",
            "button:has-text('View Your Jobs √Ç¬ª'):visible",
            "button:visible:first"
          ],
          "waitAfterClick": 30000,
          "waitForUrlChange": true,
          "retryIfNoNavigation": true
        }
      },
      {
        "pageNumber": 2,
        "pageName": "Personal Info",
        "pageDetection": {
          "checkForElement": "input[name='fname'], input[name='lname'], input[name='email'], #male, #female"
        },
        "fields": [
          {
            "fieldType": "firstName",
            "selectors": [
              "input[name='fname']:visible",
              "input[placeholder*='First Name']:visible"
            ],
            "action": "type"
          },
          {
            "fieldType": "lastName",
            "selectors": [
              "input[name='lname']:visible",
              "input[placeholder*='Last Name']:visible"
            ],
            "action": "type"
          },
          {
            "fieldType": "email",
            "selectors": [
              "input[name='email']:visible",
              "input[type='email']:visible"
            ],
            "action": "type"
          }
        ],
        "navigation": {
          "type": "button",
          "selectors": [
            "button:has-text('Continue'):visible",
            "button:visible:first"
          ],
          "waitAfterClick": 30000,
          "waitForUrlChange": true,
          "retryIfNoNavigation": true
        }
      },
      {
        "pageNumber": 3,
        "pageName": "Address Entry",
        "optional": true,
        "pageDetection": {
          "checkForElement": "input[name='addr1'], input[name='city'], select[name='state'], input[name='zip']"
        },
        "fields": [
          {
            "fieldType": "address",
            "selectors": [
              "input[name='addr1']:visible"
            ],
            "action": "type"
          },
          {
            "fieldType": "apt",
            "selectors": [
              "input[name='addr2']:visible"
            ],
            "action": "type",
            "optional": true
          },
          {
            "fieldType": "city",
            "selectors": [
              "input[name='city']:visible"
            ],
            "action": "type"
          },
          {
            "fieldType": "state",
            "selectors": [
              "select[name='state']:visible"
            ],
            "action": "select"
          },
          {
            "fieldType": "zipCode",
            "selectors": [
              "input[name='zip']:visible"
            ],
            "action": "type"
          }
        ],
        "navigation": {
          "type": "button",
          "selectors": [
            "button:has-text('Continue'):visible",
            "button:visible:first"
          ],
          "waitAfterClick": 30000,
          "waitForUrlChange": true,
          "retryIfNoNavigation": true
        }
      },
      {
        "pageNumber": 4,
        "pageName": "Phone and Additional Info",
        "pageDetection": {
          "checkForElement": "input[name='phone'], select[type='month'], select[type='day'], select[type='year'], #leadid_tcpa_disclosure"
        },
        "fields": [
          {
            "fieldType": "phone",
            "selectors": [
              "input[name='phone']:visible",
              "input[type='tel']:visible"
            ],
            "action": "type"
          },
          {
            "fieldType": "dobMonth",
            "selectors": [
              "select[type='month']:visible",
              "select[autocomplete='bday-month']:visible"
            ],
            "action": "select",
            "optional": true
          },
          {
            "fieldType": "dobDay",
            "selectors": [
              "select[type='day']:visible",
              "select[autocomplete='bday-day']:visible"
            ],
            "action": "select",
            "optional": true
          },
          {
            "fieldType": "dobYear",
            "selectors": [
              "select[type='year']:visible",
              "select[autocomplete='bday-year']:visible"
            ],
            "action": "select",
            "optional": true
          },
          {
            "fieldType": "consentCheckbox",
            "selectors": [
              "#leadid_tcpa_disclosure:visible",
              "input[name='tcpa-box']:visible",
              "input[type='checkbox']:visible"
            ],
            "action": "click",
            "required": true
          }
        ],
        "navigation": {
          "type": "button",
          "selectors": [
            "button:has-text('I AGREE'):visible",
            "button[data-text*='I AGREE']:visible",
            "button.sc-pZOBi:visible",
            "button[type='button']:visible:last"
          ],
          "waitAfterClick": 30000,
          "waitForUrlChange": true,
          "retryIfNoNavigation": true
        }
      },
      {
        "pageNumber": 5,
        "pageName": "Dynamic Survey/Offer Page 1",
        "isDynamic": true,
        "pageDetection": {
          "variations": [
            {
              "name": "Employment Status Survey",
              "detection": {
                "checkForText": [
                  "What best describes your current employment status?",
                  "current employment status"
                ],
                "checkForElement": "div:has-text('current employment status'), div.sc-pciEQ"
              },
              "fields": [],
              "navigation": {
                "type": "randomChoice",
                "choices": [
                  {
                    "selectors": ["button:has-text('Full Time'):visible"]
                  },
                  {
                    "selectors": ["button:has-text('Part Time'):visible"]
                  },
                  {
                    "selectors": ["button:has-text('Unemployed'):visible"]
                  }
                ],
                "waitAfterClick": 30000,
                "waitForUrlChange": true,
                "retryIfNoNavigation": true
              }
            },
            {
              "name": "Fresh Careers Offer",
              "detection": {
                "checkForText": [
                  "Interested in getting daily Work From Home job alerts via SMS?",
                  "job alerts via SMS"
                ],
                "checkForElement": "div:has-text('job alerts via SMS'), div.sc-pZOBi"
              },
              "fields": [],
              "navigation": {
                "type": "button",
                "selectors": [
                  "[data-testid='skipButton']:visible",
                  "div[data-testid='skipButton']:visible",
                  "div:has-text('Skip'):visible"
                ],
                "waitAfterClick": 30000,
                "waitForUrlChange": true,
                "retryIfNoNavigation": true
              }
            }
          ],
          "fallback": {
            "logUnknownPage": true,
            "takeScreenshot": true,
            "tryCommonButtons": ["Continue", "Next", "Skip"]
          }
        }
      },
      {
        "pageNumber": 6,
        "pageName": "Dynamic Survey/Offer Page 2",
        "isDynamic": true,
        "optional": true,
        "pageDetection": {
          "logging": {
            "onPageLoad": "üîç Checking for additional dynamic pages (Page 6)...",
            "onDetectionStart": "üìã Attempting to identify page type..."
          },
          "variations": [],
          "fallback": {
            "logging": {
              "onUnknown": "‚ö†Ô∏è Unknown page type at position 6 - capturing for future mapping",
              "onScreenshot": "üì∏ Screenshot saved for page mapping",
              "onUrlCapture": "üîó Page URL: {url}",
              "onTextCapture": "üìÑ Visible text elements captured",
              "onFallbackAction": "üîÑ Trying common navigation: Continue/Next/Skip..."
            },
            "logUnknownPage": true,
            "takeScreenshot": true,
            "captureVisibleText": true,
            "tryCommonButtons": ["Continue", "Next", "Skip", "Submit"]
          }
        }
      },
      {
        "pageNumber": 7,
        "pageName": "Dynamic Survey/Offer Page 3",
        "isDynamic": true,
        "optional": true,
        "pageDetection": {
          "logging": {
            "onPageLoad": "üîç Checking for additional dynamic pages (Page 7)...",
            "onDetectionStart": "üìã Attempting to identify page type...",
            "onFinalPage": "üèÅ Checking if this is the final page..."
          },
          "variations": [],
          "fallback": {
            "logging": {
              "onUnknown": "‚ö†Ô∏è Unknown page type at position 7 - capturing for future mapping",
              "onScreenshot": "üì∏ Screenshot saved for page mapping",
              "onUrlCapture": "üîó Page URL: {url}",
              "onTextCapture": "üìÑ Visible text elements captured",
              "onFallbackAction": "üîÑ Trying common navigation: Continue/Next/Skip/Submit/Finish...",
              "onComplete": "‚úÖ Funnel completion detected"
            },
            "logUnknownPage": true,
            "takeScreenshot": true,
            "captureVisibleText": true,
            "tryCommonButtons": ["Continue", "Next", "Skip", "Submit", "Finish"]
          }
        }
      }
    ]
  },
  "settings": {
    "delays": {
      "betweenFields": [500, 1500],
      "typingSpeed": 100,
      "beforeNavigation": 2000,
      "afterNavigation": 5000
    },
    "navigationTimeout": 30000,
    "pageFlowVariations": {
      "allowSkipOptionalPages": true,
      "maxRetries": 3,
      "detectPageRedirects": true,
      "handleDynamicPages": true
    },
    "dynamicPageHandling": {
      "maxAttemptsPerVariation": 2,
      "textMatchStrategy": "fullThenPartial",
      "continueOnUnknown": true
    },
    "antiDetection": {
      "randomizeTimings": true,
      "simulateHumanBehavior": true,
      "rotateUserAgents": true
    }
  }
}
